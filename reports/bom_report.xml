<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_bom_production_sheet" inherit_id="mrp.report_bom_structure">
        <xpath expr="//t[@t-call='web.html_container']" position="inside">
            <t t-foreach="docs" t-as="bom">
                <div class="page" style="page-break-before: always;">
                    <!-- Header -->
                    <div class="text-center mb-4">
                        <h2>PRODUCTION SHEET</h2>
                        <h3><t t-esc="bom.product_tmpl_id.name"/></h3>
                        <p>Reference: <t t-esc="bom.code or 'N/A'"/></p>
                    </div>
                    
                    <!-- Barcode Section -->
                    <t t-if="bom.production_barcode">
                        <div class="text-center mb-4 p-3" style="border: 2px solid #000;">
                            <h4>SCAN TO PRODUCE 1 BATCH</h4>
                            <img t-attf-src="/report/barcode/Code128/{{bom.production_barcode}}?width=600&amp;height=150&amp;humanreadable=1" 
                                 alt="Barcode" 
                                 style="max-width: 100%;"/>
                            <p class="mt-3"><strong style="font-size: 18px;"><t t-esc="bom.production_barcode"/></strong></p>
                        </div>
                    </t>
                    
                    <!-- Ingredients Table -->
                    <h4>Ingredients per Batch</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th style="width: 40%;">Ingredient</th>
                                <th class="text-center" style="width: 20%;">1 Batch</th>
                                <th class="text-center" style="width: 20%;">2 Batches</th>
                                <th class="text-center" style="width: 20%;">3 Batches</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-foreach="bom.bom_line_ids" t-as="line">
                                <tr>
                                    <td><strong><t t-esc="line.product_id.name"/></strong></td>
                                    <td class="text-center">
                                        <t t-esc="'{:.2f}'.format(line.product_qty)"/> 
                                        <t t-esc="line.product_uom_id.name"/>
                                    </td>
                                    <td class="text-center">
                                        <t t-esc="'{:.2f}'.format(line.product_qty * 2)"/> 
                                        <t t-esc="line.product_uom_id.name"/>
                                    </td>
                                    <td class="text-center">
                                        <t t-esc="'{:.2f}'.format(line.product_qty * 3)"/> 
                                        <t t-esc="line.product_uom_id.name"/>
                                    </td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                    
                    <!-- Production Info -->
                    <div class="row mt-4">
                        <div class="col-6">
                            <p><strong>Yield per Batch:</strong> 
                                <t t-esc="'{:.2f}'.format(bom.product_qty)"/> 
                                <t t-esc="bom.product_uom_id.name"/>
                            </p>
                        </div>
                        <div class="col-6">
                            <p><strong>Date:</strong> _____________________</p>
                            <p><strong>Prepared by:</strong> _____________________</p>
                            <p><strong>Checked by:</strong> _____________________</p>
                        </div>
                    </div>
                </div>
            </t>
        </xpath>
    </template>
</odoo>